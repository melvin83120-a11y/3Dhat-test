<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Test Chapeau GLB</title>
<style>
  body { margin:0; overflow:hidden; background:#111; color:white; font-family:sans-serif; }
  #controls { position:absolute; top:10px; left:10px; background:rgba(0,0,0,0.6); padding:10px; border-radius:10px; }
  input[type=range] { width:150px; }
  #loading { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:20px; }
</style>
</head>
<body>

<div id="controls">
  <label>√âchelle:</label><br>
  <input type="range" id="scaleRange" min="0.1" max="5" step="0.1" value="1"><br><br>

  <label>Position X:</label><br>
  <input type="range" id="posX" min="-5" max="5" step="0.1" value="0"><br><br>

  <label>Position Y:</label><br>
  <input type="range" id="posY" min="-5" max="5" step="0.1" value="0"><br><br>

  <label>Position Z:</label><br>
  <input type="range" id="posZ" min="-5" max="5" step="0.1" value="0"><br>
</div>

<div id="loading">Chargement du mod√®le...</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.150.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.150.0/examples/js/loaders/GLTFLoader.js"></script>

<script>
let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
let renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

let light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(1, 1, 1).normalize();
scene.add(light);
scene.add(new THREE.AmbientLight(0x404040));

camera.position.z = 3;

let hat;
const loadingDiv = document.getElementById("loading");
const controlsDiv = document.getElementById("controls");

// üîó Lien GitHub Pages (√† remplacer si n√©cessaire)
const hatURL = "https://melvin83120-a11y.github.io/3Dhat-test/Chapeau.glb";

const loader = new THREE.GLTFLoader();
loader.load(
  hatURL,
  (gltf) => {
    hat = gltf.scene;
    scene.add(hat);

    // Centrer le mod√®le
    const box = new THREE.Box3().setFromObject(hat);
    const center = box.getCenter(new THREE.Vector3());
    hat.position.sub(center);

    loadingDiv.style.display = "none";
    controlsDiv.style.display = "block";
  },
  (xhr) => {
    if (xhr.total) {
      const percent = (xhr.loaded / xhr.total * 100).toFixed(0);
      loadingDiv.textContent = "Chargement... " + percent + "%";
    }
  },
  (error) => {
    loadingDiv.textContent = "‚ùå Erreur de chargement du mod√®le GLB";
    console.error(error);
  }
);

// Curseurs
document.getElementById("scaleRange").addEventListener("input", e => {
  if (hat) {
    const s = parseFloat(e.target.value);
    hat.scale.set(s,s,s);
  }
});
document.getElementById("posX").addEventListener("input", e => { if(hat) hat.position.x = parseFloat(e.target.value); });
document.getElementById("posY").addEventListener("input", e => { if(hat) hat.position.y = parseFloat(e.target.value); });
document.getElementById("posZ").addEventListener("input", e => { if(hat) hat.position.z = parseFloat(e.target.value); });

// Animation
function animate() {
  requestAnimationFrame(animate);
  renderer.render(scene, camera);
}
animate();

window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
